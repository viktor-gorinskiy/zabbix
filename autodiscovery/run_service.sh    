#/bin/bash
#автообнаружение сервисов для заббикс-агента
if [ -z "$(echo -n $@)" ]
then exit 0
fi

printf "{\"data\":["

for service in $@
do
        if pgrep $service > /dev/null 2>&1
        then printf $var"{\"{#SERVICE}\":\"$service\"}"
        else
        if systemctl is-enabled --quiet $service 2>/dev/null;then printf $var"{\"{#SERVICE}\":\"$service\"}";fi
        fi
var=","
done

printf "]}"

exit 0

